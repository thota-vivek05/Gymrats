<!-- views/user_nutrition.ejs -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GymRats - Personalized Nutrition Guide</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="/nutrition/user_nutrition.css">
    <link rel="stylesheet" type="text/css" href="/userdashboard/userdashboard.css" />
</head>
<body>
    <!-- User Dashboard Header -->
    <div class="main-navbar">
        <header>
            <div class="brand-logo">
                <a href="<%= user && user.membership ? '/userdashboard_' + user.membership.charAt(0).toLowerCase() : '/dashboard' %>" class="brand-name">GymRats</a>
            </div>
            
            <div class="nav-menu">
                <a href="<%= user && user.membership ? '/userdashboard_' + user.membership.charAt(0).toLowerCase() : '/dashboard' %>" class="<%= currentPage === 'dashboard' ? 'active' : '' %>">Home</a>
                <a href="/user_exercises" class="<%= currentPage === 'exercises' ? 'active' : '' %>">Exercises</a>
                <a href="/user_nutrition" class="<%= currentPage === 'nutrition' ? 'active' : '' %>">Nutrition</a>
            </div>
            
            <div class="right-container">
                <div class="search-container">
                    <img src="/userdashboard/icons8-search.svg" height="18px" alt="Search Icon" />
                    <input type="text" placeholder="Search..." size="20" style="font-size: 14px;" />
                </div>
                
                <div class="user-profile">
                    <a href="/userprofile" class="<%= currentPage === 'profile' ? 'active' : '' %>">
                        <% if (user && user.name) { %>
                            <span><%= user.name %></span>
                        <% } else if (user && user.full_name) { %>
                            <span><%= user.full_name.split(' ')[0] %></span>
                        <% } else { %>
                            <span>User</span>
                        <% } %>
                    </a>
                </div>
            </div>
            <div class="mobile-menu-icon" id="menuIcon">
                <img src="/userdashboard/menu.jpg" alt="Menu" height="25px" />
            </div>
            <div class="mobile-sidebar" id="sideNavbar">
                <a href="javascript:void(0)" class="close-button" id="closeBtn">&times;</a>
                <a href="<%= user && user.membership ? '/userdashboard_' + user.membership.charAt(0).toLowerCase() : '/dashboard' %>" class="<%= currentPage === 'dashboard' ? 'active' : '' %>">Home</a>
                <a href="/user_exercises" class="<%= currentPage === 'exercises' ? 'active' : '' %>">Exercises</a>
                <a href="/user_nutrition" class="<%= currentPage === 'nutrition' ? 'active' : '' %>">Nutrition</a>
                <div class="sidebar-profile">
                    <a href="/userprofile">
                        <% if (user && user.name) { %>
                            <span><%= user.name %></span>
                        <% } else if (user && user.full_name) { %>
                            <span><%= user.full_name.split(' ')[0] %></span>
                        <% } else { %>
                            <span>User</span>
                        <% } %>
                    </a>
                </div>
            </div>
        </header>
    </div>

    <!-- Personalized Welcome Banner -->
    <div class="welcome-banner">
        <h1>Welcome, <%= user && user.name ? user.name : 'Athlete' %>!</h1>
        <p>Nutrition Plan Optimized for Your Training Style</p>
        <div class="user-badges">
            <% if (user && user.workout_type) { %>
                <div class="goal-badge">
                    <i class="fas fa-dumbbell"></i>
                    Training: <%= user.workout_type %>
                </div>
            <% } %>
            <% if (user && user.fitness_goal) { %>
                <div class="goal-badge">
                    <i class="fas fa-bullseye"></i>
                    Goal: <%= user.fitness_goal %>
                </div>
            <% } %>
        </div>
    </div>

    <!-- Main Content -->
    <div class="container">
        <!-- Quick Nutrition Overview -->
        <div class="section">
            <h2>Your Nutrition Blueprint</h2>
            <div class="quick-stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-bolt"></i>
                    </div>
                    <div class="stat-content">
                        <h3>Energy Focus</h3>
                        <p>
                            <% if (user && user.workout_type) { 
                                switch(user.workout_type.toLowerCase()) {
                                    case 'weight loss':
                                    case 'hiit':
                                        %>Calorie Deficit & Fat Burning<%;
                                        break;
                                    case 'bodybuilding':
                                        %>Muscle Growth & Recovery<%;
                                        break;
                                    case 'strength':
                                        %>Power Output & CNS Recovery<%;
                                        break;
                                    case 'cardio':
                                        %>Endurance & Glycogen Storage<%;
                                        break;
                                    case 'calisthenics':
                                        %>Strength-to-Weight Ratio<%;
                                        break;
                                    default:
                                        %>Balanced Energy & Performance<%;
                                }
                            } else { %>
                                Balanced Energy & Performance
                            <% } %>
                        </p>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-apple-alt"></i>
                    </div>
                    <div class="stat-content">
                        <h3>Macro Priority</h3>
                        <p>
                            <% if (user && user.workout_type) { 
                                switch(user.workout_type.toLowerCase()) {
                                    case 'weight loss':
                                    case 'hiit':
                                        %>High Protein, Moderate Carbs<%;
                                        break;
                                    case 'bodybuilding':
                                        %>High Protein & Carbs<%;
                                        break;
                                    case 'strength':
                                        %>Balanced Macros, Timing Focus<%;
                                        break;
                                    case 'cardio':
                                        %>High Carbs, Moderate Protein<%;
                                        break;
                                    case 'calisthenics':
                                        %>Lean Protein, Smart Carbs<%;
                                        break;
                                    default:
                                        %>Balanced Macronutrients<%;
                                }
                            } else { %>
                                Balanced Macronutrients
                            <% } %>
                        </p>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-clock"></i>
                    </div>
                    <div class="stat-content">
                        <h3>Meal Timing</h3>
                        <p>
                            <% if (user && user.workout_type) { 
                                switch(user.workout_type.toLowerCase()) {
                                    case 'weight loss':
                                    case 'hiit':
                                        %>Intermittent Fasting Friendly<%;
                                        break;
                                    case 'bodybuilding':
                                        %>Frequent Meals (5-6x daily)<%;
                                        break;
                                    case 'strength':
                                        %>Pre/Post Workout Focus<%;
                                        break;
                                    case 'cardio':
                                        %>Carb Timing Around Sessions<%;
                                        break;
                                    default:
                                        %>Regular Meal Pattern<%;
                                }
                            } else { %>
                                Regular Meal Pattern
                            <% } %>
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Workout-Specific Nutrition Guide -->
        <div class="section">
            <h2>Nutrition for <%= user && user.workout_type ? user.workout_type : 'Your Training' %></h2>
            
            <div class="workout-nutrition-grid">
                <!-- HIIT & Weight Loss -->
                <% if (!user || !user.workout_type || ['weight loss', 'hiit'].includes(user.workout_type.toLowerCase())) { %>
                <div class="workout-plan-card">
                    <div class="workout-header hiit">
                        <h3><i class="fas fa-fire"></i> HIIT & Weight Loss</h3>
                        <span class="intensity-tag">High Intensity</span>
                    </div>
                    <div class="nutrition-focus">
                        <h4>Nutrition Focus</h4>
                        <ul>
                            <li>Calorie deficit (300-500kcal below maintenance)</li>
                            <li>High protein intake (2.0-2.4g/kg)</li>
                            <li>Strategic carb timing around workouts</li>
                            <li>Emphasis on fiber and volume eating</li>
                        </ul>
                    </div>
                    <div class="food-examples">
                        <h4>Optimal Foods</h4>
                        <div class="food-grid">
                            <span class="food-item">Chicken Breast</span>
                            <span class="food-item">Greek Yogurt</span>
                            <span class="food-item">Leafy Greens</span>
                            <span class="food-item">Berries</span>
                            <span class="food-item">Egg Whites</span>
                            <span class="food-item">Sweet Potato</span>
                        </div>
                    </div>
                </div>
                <% } %>

                <!-- Bodybuilding -->
                <% if (user && user.workout_type && ['bodybuilding', 'muscle gain'].includes(user.workout_type.toLowerCase())) { %>
                <div class="workout-plan-card">
                    <div class="workout-header bodybuilding">
                        <h3><i class="fas fa-weight-hanging"></i> Bodybuilding</h3>
                        <span class="intensity-tag">Mass Building</span>
                    </div>
                    <div class="nutrition-focus">
                        <h4>Nutrition Focus</h4>
                        <ul>
                            <li>Calorie surplus (300-500kcal above maintenance)</li>
                            <li>High protein (1.8-2.4g/kg) for muscle repair</li>
                            <li>Consistent carb intake throughout day</li>
                            <li>Post-workout nutrition critical</li>
                        </ul>
                    </div>
                    <div class="food-examples">
                        <h4>Optimal Foods</h4>
                        <div class="food-grid">
                            <span class="food-item">Lean Beef</span>
                            <span class="food-item">Brown Rice</span>
                            <span class="food-item">Cottage Cheese</span>
                            <span class="food-item">Oats</span>
                            <span class="food-item">Salmon</span>
                            <span class="food-item">Quinoa</span>
                        </div>
                    </div>
                </div>
                <% } %>

                <!-- Strength Training -->
                <% if (user && user.workout_type && ['strength', 'powerlifting'].includes(user.workout_type.toLowerCase())) { %>
                <div class="workout-plan-card">
                    <div class="workout-header strength">
                        <h3><i class="fas fa-bolt"></i> Strength Training</h3>
                        <span class="intensity-tag">Power Focus</span>
                    </div>
                    <div class="nutrition-focus">
                        <h4>Nutrition Focus</h4>
                        <ul>
                            <li>Maintenance calories or slight surplus</li>
                            <li>Moderate-high protein (1.6-2.2g/kg)</li>
                            <li>Carb-focused pre-workout meals</li>
                            <li>Adequate fats for hormone production</li>
                        </ul>
                    </div>
                    <div class="food-examples">
                        <h4>Optimal Foods</h4>
                        <div class="food-grid">
                            <span class="food-item">Steak</span>
                            <span class="food-item">Potatoes</span>
                            <span class="food-item">Whole Eggs</span>
                            <span class="food-item">Avocado</span>
                            <span class="food-item">Whole Wheat Pasta</span>
                            <span class="food-item">Nuts</span>
                        </div>
                    </div>
                </div>
                <% } %>

                <!-- Cardio & Endurance -->
                <% if (user && user.workout_type && ['cardio', 'endurance'].includes(user.workout_type.toLowerCase())) { %>
                <div class="workout-plan-card">
                    <div class="workout-header cardio">
                        <h3><i class="fas fa-running"></i> Cardio & Endurance</h3>
                        <span class="intensity-tag">Stamina Focus</span>
                    </div>
                    <div class="nutrition-focus">
                        <h4>Nutrition Focus</h4>
                        <ul>
                            <li>Higher carbohydrate intake (5-8g/kg)</li>
                            <li>Moderate protein (1.4-1.8g/kg)</li>
                            <li>Emphasis on glycogen replenishment</li>
                            <li>Electrolyte and hydration management</li>
                        </ul>
                    </div>
                    <div class="food-examples">
                        <h4>Optimal Foods</h4>
                        <div class="food-grid">
                            <span class="food-item">Bananas</span>
                            <span class="food-item">Oatmeal</span>
                            <span class="food-item">Chicken</span>
                            <span class="food-item">Energy Gels</span>
                            <span class="food-item">Sports Drinks</span>
                            <span class="food-item">Whole Grain Bread</span>
                        </div>
                    </div>
                </div>
                <% } %>

                <!-- Calisthenics -->
                <% if (user && user.workout_type && ['calisthenics'].includes(user.workout_type.toLowerCase())) { %>
                <div class="workout-plan-card">
                    <div class="workout-header calisthenics">
                        <h3><i class="fas fa-user"></i> Calisthenics</h3>
                        <span class="intensity-tag">Body Control</span>
                    </div>
                    <div class="nutrition-focus">
                        <h4>Nutrition Focus</h4>
                        <ul>
                            <li>Maintenance calories for optimal strength-to-weight</li>
                            <li>Moderate protein (1.6-2.0g/kg)</li>
                            <li>Complex carbs for sustained energy</li>
                            <li>Anti-inflammatory foods for joint health</li>
                        </ul>
                    </div>
                    <div class="food-examples">
                        <h4>Optimal Foods</h4>
                        <div class="food-grid">
                            <span class="food-item">Fish</span>
                            <span class="food-item">Brown Rice</span>
                            <span class="food-item">Nuts & Seeds</span>
                            <span class="food-item">Berries</span>
                            <span class="food-item">Leafy Greens</span>
                            <span class="food-item">Sweet Potatoes</span>
                        </div>
                    </div>
                </div>
                <% } %>

                <!-- General Training (Fallback) -->
                <% if (!user || !user.workout_type) { %>
                <div class="workout-plan-card">
                    <div class="workout-header general">
                        <h3><i class="fas fa-dumbbell"></i> General Fitness</h3>
                        <span class="intensity-tag">Balanced Approach</span>
                    </div>
                    <div class="nutrition-focus">
                        <h4>Nutrition Focus</h4>
                        <ul>
                            <li>Maintenance calories</li>
                            <li>Balanced macronutrients</li>
                            <li>Protein: 1.6-2.0g/kg bodyweight</li>
                            <li>Emphasis on whole foods and variety</li>
                        </ul>
                    </div>
                    <div class="food-examples">
                        <h4>Optimal Foods</h4>
                        <div class="food-grid">
                            <span class="food-item">Chicken</span>
                            <span class="food-item">Rice</span>
                            <span class="food-item">Vegetables</span>
                            <span class="food-item">Fruits</span>
                            <span class="food-item">Eggs</span>
                            <span class="food-item">Whole Grains</span>
                        </div>
                    </div>
                </div>
                <% } %>
            </div>
        </div>

        <!-- Macronutrient Calculator -->
        <div class="section">
            <h2>Your Macronutrient Targets</h2>
            <div class="macro-calculator">
                <div class="macro-results">
                    <% 
                    let weight = user && user.weight ? user.weight : 70;
                    let protein, carbs, fat, calories;
                    
                    if (user && user.workout_type) {
                        switch(user.workout_type.toLowerCase()) {
                            case 'weight loss':
                            case 'hiit':
                                protein = Math.round(weight * 2.2);
                                carbs = Math.round(weight * 3);
                                fat = Math.round(weight * 0.8);
                                break;
                            case 'bodybuilding':
                                protein = Math.round(weight * 2.2);
                                carbs = Math.round(weight * 5);
                                fat = Math.round(weight * 1.0);
                                break;
                            case 'strength':
                                protein = Math.round(weight * 1.8);
                                carbs = Math.round(weight * 4);
                                fat = Math.round(weight * 1.2);
                                break;
                            case 'cardio':
                                protein = Math.round(weight * 1.6);
                                carbs = Math.round(weight * 6);
                                fat = Math.round(weight * 1.2);
                                break;
                            case 'calisthenics':
                                protein = Math.round(weight * 1.8);
                                carbs = Math.round(weight * 4);
                                fat = Math.round(weight * 1.0);
                                break;
                            default:
                                protein = Math.round(weight * 1.8);
                                carbs = Math.round(weight * 4);
                                fat = Math.round(weight * 1.0);
                        }
                    } else {
                        protein = Math.round(weight * 1.8);
                        carbs = Math.round(weight * 4);
                        fat = Math.round(weight * 1.0);
                    }
                    
                    calories = (protein * 4) + (carbs * 4) + (fat * 9);
                    %>
                    
                    <div class="macro-card protein">
                        <div class="macro-icon">
                            <i class="fas fa-drumstick-bite"></i>
                        </div>
                        <div class="macro-info">
                            <h3>Protein</h3>
                            <div class="macro-amount"><%= protein %>g</div>
                            <div class="macro-percentage"><%= Math.round((protein * 4) / calories * 100) %>% of calories</div>
                        </div>
                    </div>

                    <div class="macro-card carbs">
                        <div class="macro-icon">
                            <i class="fas fa-bread-slice"></i>
                        </div>
                        <div class="macro-info">
                            <h3>Carbohydrates</h3>
                            <div class="macro-amount"><%= carbs %>g</div>
                            <div class="macro-percentage"><%= Math.round((carbs * 4) / calories * 100) %>% of calories</div>
                        </div>
                    </div>

                    <div class="macro-card fat">
                        <div class="macro-icon">
                            <i class="fas fa-seedling"></i>
                        </div>
                        <div class="macro-info">
                            <h3>Fat</h3>
                            <div class="macro-amount"><%= fat %>g</div>
                            <div class="macro-percentage"><%= Math.round((fat * 9) / calories * 100) %>% of calories</div>
                        </div>
                    </div>

                    <div class="macro-card total">
                        <div class="macro-icon">
                            <i class="fas fa-fire"></i>
                        </div>
                        <div class="macro-info">
                            <h3>Total Calories</h3>
                            <div class="macro-amount"><%= calories %> kcal</div>
                            <div class="macro-note">Daily Target</div>
                        </div>
                    </div>
                </div>
                
                <div class="macro-note">
                    <p><i class="fas fa-info-circle"></i> Based on your <%= user && user.workout_type ? user.workout_type.toLowerCase() : 'general' %> training style and estimated weight of <%= weight %>kg</p>
                </div>
            </div>
        </div>

        <!-- Supplement Guide -->
        <div class="section">
            <h2>Training-Specific Supplements</h2>
            <div class="supplements-grid">
                <div class="supplement-category">
                    <h3>Essential for All</h3>
                    <div class="supplement-list">
                        <div class="supplement-item">
                            <strong>Whey Protein</strong>
                            <span>Muscle recovery and daily protein goals</span>
                        </div>
                        <div class="supplement-item">
                            <strong>Creatine Monohydrate</strong>
                            <span>Strength and power output (3-5g daily)</span>
                        </div>
                        <div class="supplement-item">
                            <strong>Multivitamin</strong>
                            <span>General health and nutrient insurance</span>
                        </div>
                    </div>
                </div>

                <div class="supplement-category">
                    <h3>For Your Training Style</h3>
                    <div class="supplement-list">
                        <% if (user && user.workout_type) { 
                            switch(user.workout_type.toLowerCase()) {
                                case 'weight loss':
                                case 'hiit': %>
                                    <div class="supplement-item">
                                        <strong>Caffeine</strong>
                                        <span>Pre-workout energy and fat burning</span>
                                    </div>
                                    <div class="supplement-item">
                                        <strong>Green Tea Extract</strong>
                                        <span>Metabolic support and antioxidant</span>
                                    </div>
                                    <%; break;
                                case 'bodybuilding': %>
                                    <div class="supplement-item">
                                        <strong>Beta-Alanine</strong>
                                        <span>Muscle endurance during volume training</span>
                                    </div>
                                    <div class="supplement-item">
                                        <strong>BCAAs</strong>
                                        <span>Intra-workout muscle preservation</span>
                                    </div>
                                    <%; break;
                                case 'strength': %>
                                    <div class="supplement-item">
                                        <strong>Beta-Alanine</strong>
                                        <span>High-intensity performance support</span>
                                    </div>
                                    <div class="supplement-item">
                                        <strong>Citrulline Malate</strong>
                                        <span>Blood flow and power output</span>
                                    </div>
                                    <%; break;
                                case 'cardio': %>
                                    <div class="supplement-item">
                                        <strong>Electrolytes</strong>
                                        <span>Hydration during long sessions</span>
                                    </div>
                                    <div class="supplement-item">
                                        <strong>BCAAs</strong>
                                        <span>Muscle preservation during endurance</span>
                                    </div>
                                    <%; break;
                                case 'calisthenics': %>
                                    <div class="supplement-item">
                                        <strong>Omega-3 Fish Oil</strong>
                                        <span>Joint health and inflammation</span>
                                    </div>
                                    <div class="supplement-item">
                                        <strong>Vitamin D</strong>
                                        <span>Bone strength and immune function</span>
                                    </div>
                                    <%; break;
                                default: %>
                                    <div class="supplement-item">
                                        <strong>Vitamin D</strong>
                                        <span>Overall health and performance</span>
                                    </div>
                                    <div class="supplement-item">
                                        <strong>Omega-3</strong>
                                        <span>Recovery and inflammation control</span>
                                    </div>
                            <% }
                        } else { %>
                            <div class="supplement-item">
                                <strong>Vitamin D</strong>
                                <span>Overall health and performance</span>
                            </div>
                            <div class="supplement-item">
                                <strong>Omega-3</strong>
                                <span>Recovery and inflammation control</span>
                            </div>
                        <% } %>
                    </div>
                </div>
            </div>
        </div>

        <!-- Quick Tips Section -->
        <div class="section">
            <h2>Quick Nutrition Tips</h2>
            <div class="tips-grid">
                <div class="tip-card">
                    <div class="tip-icon">
                        <i class="fas fa-hourglass-half"></i>
                    </div>
                    <h3>Timing Matters</h3>
                    <p>Eat protein-rich meal within 2 hours after training for optimal recovery</p>
                </div>

                <div class="tip-card">
                    <div class="tip-icon">
                        <i class="fas fa-tint"></i>
                    </div>
                    <h3>Stay Hydrated</h3>
                    <p>Drink 3-4 liters of water daily, more if you're training intensely</p>
                </div>

                <div class="tip-card">
                    <div class="tip-icon">
                        <i class="fas fa-utensils"></i>
                    </div>
                    <h3>Whole Foods First</h3>
                    <p>Focus on unprocessed foods - they provide better nutrition and satiety</p>
                </div>

                <div class="tip-card">
                    <div class="tip-icon">
                        <i class="fas fa-balance-scale"></i>
                    </div>
                    <h3>Consistency Over Perfection</h3>
                    <p>Stick to your plan 80% of the time for sustainable results</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="site-footer">
        <div class="footer-content">
            <div class="footer-column">
                <h3>GymRats</h3>
                <ul>
                    <li><a href="/about">About Us</a></li>
                    <li><a href="/trainers">Our Trainers</a></li>
                    <li><a href="/testimonial">Testimonials</a></li>
                    <li><a href="/blog">Blog</a></li>
                </ul>
            </div>

            <div class="footer-column">
                <h3>Resources</h3>
                <ul>
                    <li><a href="/isolation">Exercise Guide</a></li>
                    <li><a href="/nutrition">Nutrition Tips</a></li>
                    <li><a href="/workout_plans">Workout Plans</a></li>
                    <li><a href="/calculators">Calculators</a></li>
                </ul>
            </div>

            <div class="footer-column">
                <h3>Support</h3>
                <ul>
                    <li><a href="/contact">Contact Us</a></li>
                    <li><a href="/about">About us</a></li>
                    <li><a href="/terms">Terms of Service</a></li>
                    <li><a href="/privacy_policy">Privacy Policy</a></li>
                </ul>
            </div>

            <div class="footer-column">
                <h3>Connect With Us</h3>
                <ul>
                    <li><a href="/trainer_form">Become a Trainer</a></li>
                    <li><a href="/verifier_form">Become a Verifier</a></li>
                </ul>
                <div class="social-icons">
                    <a href="#"><img src="/home/icons8-facebook.svg" alt="Facebook"></a>
                    <a href="#"><img src="/home/icons8-instagram.svg" alt="Instagram"></a>
                    <a href="#"><img src="/home/icons8-youtube.svg" alt="YouTube"></a>
                </div>
                <p class="copyright">GymRats © 2025. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Mobile menu toggle
            document.getElementById('menuIcon').addEventListener('click', function() {
                document.getElementById('sideNavbar').classList.add('open');
            });

            document.getElementById('closeBtn').addEventListener('click', function() {
                document.getElementById('sideNavbar').classList.remove('open');
            });

            // Simple macro calculator interaction
            const macroCards = document.querySelectorAll('.macro-card');
            macroCards.forEach(card => {
                card.addEventListener('click', function() {
                    macroCards.forEach(c => c.classList.remove('active'));
                    this.classList.add('active');
                });
            });
        });
    </script>
</body>
</html>